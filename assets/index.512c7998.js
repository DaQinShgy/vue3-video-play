var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(t,l,o)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,s=(e,t)=>{for(var l in t||(t={}))a.call(t,l)&&n(e,l,t[l]);if(o)for(var l of o(t))i.call(t,l)&&n(e,l,t[l]);return e},d=(e,o)=>t(e,l(o));import{j as r,a as u,c,e as p,b as m,k as v,l as y,u as f,F as g,p as h,q as w,t as T,v as b,x as V,y as S,z as x,A as P,g as k,i as B,B as C,C as z,D as _,E as I,G as $,m as O,w as M,T as R,d as D,H as A,I as F}from"./app.9131f861.js";function E(e,t,l,o){var a,i=!1,n=0;function s(){a&&clearTimeout(a)}function d(){for(var d=arguments.length,r=new Array(d),u=0;u<d;u++)r[u]=arguments[u];var c=this,p=Date.now()-n;function m(){n=Date.now(),l.apply(c,r)}function v(){a=void 0}i||(o&&!a&&m(),s(),void 0===o&&p>e?m():!0!==t&&(a=setTimeout(o?v:m,void 0===o?e-p:e)))}return"boolean"!=typeof t&&(o=l,l=t,t=void 0),d.cancel=function(){s(),i=!0},d}function j(e,t,l){return void 0===l?E(e,t,!1):E(e,l,!1!==t)}const L={name:"d-icon"};const H=Object.assign(L,{props:{icon:String,size:[Number,String]},setup:function(e){const t=e,l=r((()=>({fontSize:/^\d+$/.test(t.size)?t.size+"px":t.size})));return(t,o)=>(u(),c(g,null,[p(' <svg class="d-icon" :style="iconSize" aria-hidden="true">\r\n    <use :xlink:href="`#${icon}`" />\r\n  </svg>'),m("i",{class:v(["d-icon iconfont",e.icon]),style:y(f(l))},null,6)],2112))}});H.__scopeId="data-v-5d933f34";var N=H;h("data-v-332478ec");const q={class:"d-player-top"},U={class:"top-title"},W={class:"top-title"};w();const X={props:{title:{default:""}},setup(e){Date.prototype.format=function(e){let t={"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};for(var l in t)new RegExp("("+l+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[l]:("00"+t[l]).substr((""+t[l]).length)));return e};let t=T("00:00:00");t.value=(new Date).format("hh:mm:ss");let l=null;return l=setInterval((()=>{t.value=(new Date).format("hh:mm:ss")}),1e3),b((()=>{clearInterval(l)})),(l,o)=>(u(),c("div",q,[m("p",U,V(e.title||""),1),m("p",W,V(f(t)),1)]))},__scopeId:"data-v-332478ec"};var K=X;h("data-v-00f6f6c9");const G={class:"d-status"},Y={class:"d-status-info"},J={class:"d-status-info"},Q=B("5X速播放中 ");w();var Z=S({props:["state"],setup:e=>(t,l)=>x((u(),c("div",G,[x(m("li",Y,[k(N,{size:"18",class:"d-status-icon",icon:"icon-volume-"+(0==e.state.volume?"mute":e.state.volume>.5?"up":"down")},null,8,["icon"]),B(" "+V(~~(100*e.state.volume))+"% ",1)],512),[[P,"volume"==e.state.handleType]]),x(m("li",J,[k(N,{size:"12",icon:"icon-play"}),k(N,{size:"12",icon:"icon-play",style:{"margin-right":"5px"}}),Q],512),[[P,"playbackRate"==e.state.handleType||e.state.isMultiplesPlay]])],512)),[[P,e.state.handleType||e.state.isMultiplesPlay]])});Z.__scopeId="data-v-00f6f6c9",h("data-v-7ffc02de");const ee=["checked","true-value","false-value"],te=m("span",{class:"d-switch_action"},null,-1);w();var le=S({props:{modelValue:{type:[Number,String,Boolean]},width:{type:String,default:"40px"},trueValue:{type:[Number,String,Boolean],default:!0},falseValue:{type:[Number,String,Boolean],default:!0},activeColor:{type:[String],default:"#409EFF"}},emits:["update:modelValue","change"],setup(e,{emit:t}){const l=e;C((t=>({"30049a3e":e.width,b24d8e50:e.activeColor})));const o=T(null),a=r((()=>l.modelValue===l.trueValue)),i=()=>{z((()=>{const e=o.value.checked;t("update:modelValue",e),t("change",e)}))};return(t,l)=>(u(),c("div",{class:v(["d-switch",{"is-checked":f(a)}])},[m("input",{class:"d-switch__input",ref:o,type:"checkbox",checked:f(a),onChange:i,"true-value":e.trueValue,"false-value":e.falseValue},null,40,ee),te],2))}});le.__scopeId="data-v-7ffc02de",h("data-v-6739ff41");const oe={key:0},ae=m("p",null,"正在缓冲...",-1),ie=B("重新播放 "),ne=B("请求错误 ");w();var se=S({props:{loadType:String,text:{type:String,default:""}},setup(e){const t=e,{proxy:l}=_(),o=()=>{l.$parent.play()},a=r((()=>{let e="background: rgba(0, 0, 0, .1);z-index:1";return"init"==t.loadType&&(e="background: rgba(0, 0, 0, 1);;z-index:3"),e}));return(t,l)=>x((u(),c("div",{class:"d-loading",style:y(f(a))},[m("div",null,[p(" 初始化加载 "),"init"==e.loadType?(u(),c("span",oe,[k(N,{class:"rotating",icon:"icon-loading",size:50}),m("p",null,V(e.text),1)])):p("v-if",!0),p(" 缓冲中 "),x(m("span",null,[k(N,{class:"rotating",icon:"icon-loading",size:50}),ae],512),[[P,"buffer"==e.loadType]]),p(" 播放结束 "),x(m("span",null,[m("p",{onClick:o,class:"d-flex-x d-pointer"},[k(N,{icon:"icon-replay",size:24,style:{"mrgin-right":"5px"}}),ie])],512),[[P,"ended"==e.loadType]]),p(" 播放错误 "),x(m("span",null,[m("p",{onClick:o,class:"d-flex-x d-pointer"},[k(N,{icon:"icon-replay",size:24,style:{"mrgin-right":"5px"}}),ne])],512),[[P,"error"==e.loadType||"stalled"==e.loadType]])])],4)),[[P,e.loadType]])}});se.__scopeId="data-v-6739ff41";const de=function(e,t,l,o=!1){e&&t&&l&&e.addEventListener(t,l,o)},re=function(e,t,l,o=!1){e&&t&&l&&e.removeEventListener(t,l,o)};h("data-v-25ddcae6");const ue=["onMousedown"];w();var ce=S(d(s({},{name:"DSlider"}),{props:{modelValue:{required:!0,type:Number,default:0},disabled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},hoverText:{type:String,default:""},preload:{type:Number,default:0},size:{type:String,default:"10px"}},emits:["update:modelValue","change","onMousemove"],setup(e,{emit:t}){const l=e;C((t=>({"5b663fc9":e.size})));const o=T(null),a=T(null),i=I({dragging:!1,hoverPosition:0,hoverTipsLeft:"50%"}),n=r((()=>{let e=l.modelValue<0?0:l.modelValue>1?1:l.modelValue;return l.vertical?`height:${100*e}%`:`width:${100*e}%`})),s=r((()=>{let e=l.preload<0?0:l.preload>1?1:l.preload;return l.vertical?`height:${100*e}%`:`width:${100*e}%`})),d=r((()=>{let e=i.hoverPosition<0?0:i.hoverPosition>1?1:i.hoverPosition;return l.vertical?`bottom:${100*e}%`:`left:${100*e}%`})),p=e=>{e.preventDefault()},g=e=>{l.disabled||(e.preventDefault(),i.dragging=!0,w(e),de(window,"mousemove",S),de(window,"touchmove",S),de(window,"mouseup",k),de(window,"touchend",k))},h=e=>{if(!l.hover)return;let n=b(e);if(t("onMousemove",e,n),i.hoverPosition=n,l.vertical)return;let s=o.value,d=a.value.clientWidth/2,r=e.clientX-s.getBoundingClientRect().left;r<d?i.hoverTipsLeft=d-r+"px":s.clientWidth-r<d?i.hoverTipsLeft=s.clientWidth-r-d+"px":i.hoverTipsLeft="50%"},w=e=>{let l=b(e);t("update:modelValue",l),t("change",e,l)},b=e=>{let t=o.value,a=0;if(l.vertical){let l=t.clientHeight;a=(t.getBoundingClientRect().bottom-e.clientY)/l}else a=(e.clientX-t.getBoundingClientRect().left)/t.clientWidth;return a<0?0:a>1?1:a},S=e=>{w(e)},k=e=>{i.dragging&&(re(window,"mousemove",S),re(window,"touchmove",S),re(window,"mouseup",k),re(window,"touchend",k),re(window,"contextmenu",k),setTimeout((()=>{i.dragging=!1}),0))};return(e,t)=>(u(),c("div",{ref:o,class:v(["d-slider",{"is-vertical":l.vertical}]),onMousedown:$(g,["stop"]),onContextmenu:p},[m("div",{class:"d-slider__runway",onMousemove:h},[x(m("div",{class:"d-slider__cursor",style:y(f(d))},[x(m("div",{class:"d-slider__tips",ref:a,style:y({left:f(i).hoverTipsLeft})},V(l.hoverText),5),[[P,l.hoverText]])],4),[[P,l.hover]]),m("div",{class:"d-slider__preload",style:y(f(s))},null,4),m("div",{class:"d-slider__bar",style:y(f(n))},null,4)],32)],42,ue))}}));ce.__scopeId="data-v-25ddcae6";const pe=e=>{let t=~~(e/3600),l=~~(e%3600/60),o=~~(e%60);return t=t<10?"0"+t:t,l=l<10?"0"+l:l,o=o<10?"0"+o:o,`${t}:${l}:${o}`},me=!!("ontouchstart"in window),ve={width:{type:String,default:"800px"},height:{type:String,default:"450px"},color:{type:String,default:"#409eff"},webFullScreen:{type:Boolean,default:!1},speed:{type:Boolean,default:!0},playsinline:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},speedRate:{type:Array,default:()=>["2.0","1.0","1.5","1.25","0.75","0.5"]},autoPlay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},mirror:{type:Boolean,default:!1},ligthOff:{type:Boolean,default:!1},volume:{type:[String,Number],default:.3},control:{type:Boolean,default:!0},title:{type:String,default:""},src:{required:!0,type:String,default:""},preload:{type:String,default:"auto"}};h("data-v-4ed08945");const ye={class:"d-player-video"},fe=["controls","webkit-playsinline","playsinline","volume","muted","loop","preload","src"],ge={class:"d-player-lightoff"},he={key:1,class:"d-player-state"},we={class:"d-play-btn"},Te=["onKeyup"],be={class:"d-control-progress"},Ve={class:"d-tool-bar"},Se={class:"d-tool-item"},xe={class:"d-tool-item d-tool-time"},Pe=m("span",{style:{margin:"0 3px"}},"/",-1),ke={class:"total-time"},Be={class:"d-tool-bar"},Ce={class:"d-tool-item",style:{width:"26px"}},ze={class:"d-tool-item-main"},_e={class:"speed-main"},Ie=["onClick"],$e={class:"d-tool-item"},Oe={class:"d-tool-item-main volume-box",style:{width:"52px"}},Me={class:"volume-text-size"},Re={class:"d-tool-item"},De={class:"d-tool-item-main"},Ae={class:"speed-main"},Fe=B(" 镜像画面 "),Ee=B(" 循环播放 "),je=B(" 关灯模式 "),Le=m("div",{class:"d-tool-item-main"},"画中画",-1),He=m("div",{class:"d-tool-item-main"},"网页全屏",-1),Ne=m("div",{class:"d-tool-item-main"},"全屏",-1);w();var qe=S(d(s({},{name:"vue3VideoPlay"}),{props:ve,emits:["loadstart","playing","error","stalled","waiting","durationchange","progress","canplay","timeupdate","ended","mirrorChange","loopChange","lightOffChange"],setup(e,{expose:t,emit:l}){const o=e;C((e=>({"3e81aaee":f(h),"7c900371":e.width,"08bd1e48":e.height})));let a=T(null),i=T(null),n=T(null),r=T(null);const y=I(d(s({dVideo:null},o),{muted:o.autoPlay,playBtnState:o.autoPlay?"pause":"play",loading:!0,waitingLoading:!1,loadStateType:"",fullScreen:!1,handleType:"",currentTime:"00:00:00",preloadBar:0,totalTime:"00:00:00",isVideoHovering:!0,speedActive:"1.0",playProgress:0,isMultiplesPlay:!1,longPressTimeout:null,progressCursorTime:"00:00:00"})),h=(w=y.color,`${parseInt("0x"+w.slice(1,3))},${parseInt("0x"+w.slice(3,5))},${parseInt("0x"+w.slice(5,7))}`);var w;const b=j(500,(()=>{y.handleType=""})),S=e=>{let t=e.type,l=e.keyCode||e.code;if(37==l||"ArrowLeft"==l){if(!o.speed)return;"keyup"==t&&(y.dVideo.currentTime=y.dVideo.currentTime<10?.1:y.dVideo.currentTime-10,ee(y.dVideo))}else if(38==l||"ArrowTop"==l)"keydown"==t&&(y.muted=!1,y.handleType="volume",b(),y.volume=y.volume+.1>1?1:y.volume+.1);else if(39==l||"ArrowRight"==l){if("keyup"==t){if(clearTimeout(y.longPressTimeout),!o.speed&&!y.longPressTimeout)return;y.isMultiplesPlay?(y.dVideo.playbackRate=y.speedActive,y.isMultiplesPlay=!1):(y.dVideo.currentTime=y.dVideo.currentTime+10,ee(y.dVideo))}else if("keydown"==t){if(!o.speed)return;y.isMultiplesPlay&&clearTimeout(y.longPressTimeout),y.longPressTimeout=setTimeout((()=>{y.isMultiplesPlay=!0,y.dVideo.playbackRate=5,y.playBtnState="play",y.dVideo.play(),y.handleType="playbackRate",b()}),500)}}else 40!=l&&"ArrowDown"!=l||"keydown"==t&&(e.preventDefault(),y.muted=!1,y.handleType="volume",b(),y.volume=y.volume-.1<0?0:y.volume-.1)},_=()=>{me||r.value.focus()},$=()=>{y.dVideo.play().catch((()=>{setTimeout((()=>{y.playBtnState="play"}),500)})),y.playBtnState="pause"},E=()=>{y.dVideo.pause(),y.playBtnState="play"},L=()=>{"play"==y.playBtnState||"replay"==y.playBtnState?$():"pause"==y.playBtnState&&E()},H=e=>{l("playing",e)},q=e=>{y.loadStateType="buffer",l("waiting",e)},U=e=>{console.log("error"),y.loadStateType="error",l("error",e)},W=e=>{console.log("网速失速"),y.loadStateType="stalled",l("stalled",e)},X=e=>{y.loadStateType="ended",y.playBtnState="replay",l("ended",e)},G=e=>{y.loadStateType="init",l("loadstart",e),console.log("开始加载")},Y=e=>{l("durationchange",e),y.totalTime=pe(e.target.duration)},J=e=>{console.log("缓冲中..."),l("progress",e);let t=e.target.duration,o=e.target.buffered.length,a=e.target.buffered.length&&e.target.buffered.end(o-1);y.preloadBar=a/t},Q=e=>{y.loadStateType="",l("canplay",e),y.autoPlay&&(y.dVideo.play(),y.playBtnState="pause")},ee=e=>{l("timeupdate",e);let t=e.duration||e.target.duration||0,o=e.currentTime||e.target.currentTime;y.playProgress=o/t,y.currentTime=pe(o)},te=()=>{y.muted=!y.muted,0==y.volume&&(y.volume=.05)},oe=(e,t)=>{let l=y.dVideo.duration||y.dVideo.target.duration;y.dVideo.currentTime=l*t,"play"==y.playBtnState&&(y.dVideo.play(),y.playBtnState="pause")},ae=(e,t)=>{y.progressCursorTime=pe(y.dVideo.duration*t)},ie=j(2500,(()=>{y.isVideoHovering=!1})),ne=e=>{y.isVideoHovering=!0,ie()},de=e=>{l("mirrorChange",e,y.dVideo)},re=e=>{l("loopChange",e,y.dVideo)},ue=e=>{l("lightOffChange",e,y.dVideo)};(async()=>{await z(),y.dVideo=i,y.dVideo.load(),_()})();const ve=()=>{var e;e=y.dVideo,document.pictureInPictureElement?document.exitPictureInPicture().catch((e=>{console.log(e,"Video failed to leave Picture-in-Picture mode.")})):e.requestPictureInPicture().catch((e=>{console.log(e,"Video failed to enter Picture-in-Picture mode.")}))},qe=()=>{(e=>{let t=document;t.webkitIsFullScreen||t.fullscreen?(document.exitFullscreen||t.webkitExitFullScreen).call(t):(e.requestFullscreen||e.webkitRequestFullScreen).call(e)})(a.value),document.webkitIsFullScreen?y.fullScreen=!1:y.fullScreen=!0};return t({play:$,pause:E,togglePlay:L}),(e,t)=>(u(),c("div",{ref:a,class:v(["d-player-wrap",{"web-full-screen":f(y).webFullScreen,"is-lightoff":f(y).lightOff,"d-player-wrap-hover":"pause"==f(y).playBtnState||f(y).isVideoHovering}]),onMousemove:ne},[p(" 如果是移动端并且支持倍速 controls=true 否则为flase "),m("div",ye,[m("video",O({ref:i,class:["d-player-video-main",{"video-mirror":f(y).mirror}],controls:!(!f(me)||!f(y).speed),"webkit-playsinline":o.playsinline,playsinline:o.playsinline},e.$attrs,{onWaiting:q,onError:U,onStalled:W,onPlaying:H,onLoadstart:G,onDurationchange:Y,onProgress:J,onCanplay:Q,onTimeupdate:ee,onEnded:X,volume:f(y).volume,muted:f(y).muted,loop:f(y).loop,preload:e.preload,width:"100%",height:"100%",src:o.src,poster:"https://xdlumia.oss-cn-beijing.aliyuncs.com/videos/02.jpg"}),"您的浏览器不支持Video标签。",16,fe)]),p(" 缓冲动画 "),p(' <d-waitingloading text="正在缓冲..." v-show="state.waitingLoading" /> '),p(" 预加载动画 "),k(se,{loadType:f(y).loadStateType},null,8,["loadType"]),k(R,{name:"d-fade-in"},{default:M((()=>[x(m("div",ge,null,512),[[P,f(y).lightOff]])])),_:1}),p(" 全屏模式&&鼠标滑过 顶部显示的内容 "),f(y).fullScreen&&f(y).isVideoHovering?(u(),D(K,{key:0,title:o.title},null,8,["title"])):p("v-if",!0),p(" 状态栏 移动端不显示"),f(me)?p("v-if",!0):(u(),c("div",he,[k(R,{name:"d-scale-out"},{default:M((()=>[x(m("div",we,[k(N,{icon:"icon-play",size:40})],512),[[P,"play"==f(y).playBtnState]])])),_:1}),p(" 操作信息通知 "),k(Z,{state:f(y)},null,8,["state"])])),p(" 移动端不显示 "),f(me)?p("v-if",!0):(u(),c("input",{key:2,type:"input",readonly:"readonly",ref:r,onDblclick:qe,onClick:L,onKeyup:[A(L,["space"]),S],onKeydown:S,class:"d-player-input",maxlength:"0"},null,40,Te)),p(" PC端播放按钮控制器  移动端调用自带控制器"),!f(me)&&f(y).control?(u(),c("div",{key:3,class:"d-player-control",ref:n},[m("div",be,[k(ce,{class:"d-progress-bar",onOnMousemove:ae,onChange:oe,disabled:!f(y).speed,style:{"z-index":"1"},hoverText:f(y).progressCursorTime,modelValue:f(y).playProgress,"onUpdate:modelValue":t[0]||(t[0]=e=>f(y).playProgress=e),preload:f(y).preloadBar},null,8,["disabled","hoverText","modelValue","preload"])]),m("div",{class:"d-control-tool",onClick:_},[m("div",Ve,[m("div",Se,[k(N,{onClick:L,size:"24",icon:`icon-${f(y).playBtnState}`},null,8,["icon"])]),p(" 下一部 "),p(' <div class="d-tool-item">\r\n            <d-icon size="18" icon="icon-next"></d-icon>\r\n          </div>'),m("div",xe,[m("span",null,V(f(y).currentTime),1),Pe,m("span",ke,V(f(y).totalTime),1)])]),m("div",Be,[m("div",Ce,[B(V("1.0"==f(y).speedActive?"倍速":f(y).speedActive+"X")+" ",1),m("div",ze,[m("ul",_e,[(u(!0),c(g,null,F(f(y).speedRate,(e=>(u(),c("li",{class:v({"speed-active":f(y).speedActive==e}),onClick:t=>(e=>{y.speedActive=e,y.dVideo.playbackRate=e})(e),key:e},V(e)+"X",11,Ie)))),128))])])]),p(" 音量 "),m("div",$e,[m("div",Oe,[m("div",{class:v(["volume-main",{"is-muted":f(y).muted}])},[m("span",Me,V(f(y).muted?0:~~(100*f(y).volume))+"%",1),p(" @change 如果修改音量则取消静音 "),k(ce,{onChange:t[1]||(t[1]=e=>f(y).muted=!1),hover:!1,size:"5px",vertical:!0,modelValue:f(y).volume,"onUpdate:modelValue":t[2]||(t[2]=e=>f(y).volume=e)},null,8,["modelValue"])],2)]),m("span",{onClick:te,style:{display:"flex"}},[k(N,{size:"20",icon:"icon-volume-"+(0==f(y).volume||f(y).muted?"mute":f(y).volume>.5?"up":"down")},null,8,["icon"])])]),p(" 设置 "),m("div",Re,[k(N,{size:"20",class:"rotateHover",icon:"icon-settings"}),m("div",De,[m("ul",Ae,[m("li",null,[Fe,k(le,{onChange:de,modelValue:f(y).mirror,"onUpdate:modelValue":t[3]||(t[3]=e=>f(y).mirror=e)},null,8,["modelValue"])]),m("li",null,[Ee,k(le,{onChange:re,modelValue:f(y).loop,"onUpdate:modelValue":t[4]||(t[4]=e=>f(y).loop=e)},null,8,["modelValue"])]),m("li",null,[je,k(le,{onChange:ue,modelValue:f(y).lightOff,"onUpdate:modelValue":t[5]||(t[5]=e=>f(y).lightOff=e)},null,8,["modelValue"])])])])]),p(" 画中画 "),m("div",{class:"d-tool-item",onClick:ve},[k(N,{size:"20",icon:"icon-pip"}),Le]),p(" 画中画 "),m("div",{class:"d-tool-item",onClick:t[6]||(t[6]=e=>f(y).webFullScreen=!f(y).webFullScreen)},[k(N,{size:"20",icon:"icon-web-screen"}),He]),p(" 全屏 "),m("div",{class:"d-tool-item",onClick:qe},[Ne,k(N,{size:"20",icon:"icon-screen"})])])])],512)):p("v-if",!0)],34))}}));function Ue(e){e.component(qe.name,qe)}qe.__scopeId="data-v-4ed08945",qe.install=Ue;export{qe as default,Ue as install,qe as videoPlay};
